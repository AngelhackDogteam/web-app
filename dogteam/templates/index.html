{% load staticfiles %}

<!DOCTYPE html>
<html>
<head>
  <title>Dogfinder</title>
  <link href="{% static "dogteam/normalize.css" %}" rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="{% static "dogteam/welcome.css" %}" />
  <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700,800' rel='stylesheet' type='text/css'>
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">

</head>
<body>
<div id="main">
	<div class="top-bar">
		<h1 class="title"><a><img class="logo" src="{% static "dogteam/logo.png" %}" alt="logo"></a></h1>
		<div class="btn-area">
		<div class="walkthrough-btn">
			<img src="{% static "dogteam/sparklesblack.png" %}">
		</div>
	</div>


		<nav>
<!-- 			<a class="walkthrough-btn"><i class="fa fa-paw"></i> Pun Button</a>
 -->		</nav>
	</div>
	<div id="container">
	</div>
</div>
<div id="details-pane">

	<i class="fa fa-times"></i>

	<div class="details-header">
		<img class="portrait" src="http://placekitten.com/300/300" alt="Barkzilla">
		<h1>BARKZILLA</h1>
	</div>
	<div class="details-content">
	<p class="description">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Aperiam, ullam ea harum facilis tempore rem assumenda eum architecto nam. Debitis, porro est magni accusantium alias explicabo ipsa doloribus aspernatur doloremque!</p>

  <b>Currently at:</b> <space id='shelter-name'></space> <br>
  <b>City:</b> <space id='shelter-city'></space> <br>
  <b>State:</b> <space id='shelter-state'></space> <br>
  <b>Email:</b> <space id='shelter-email'></space> <br>
  <b>Phone:</b> <space id='shelter-number'></space> <br>
	<!-- <div class="badge"></div>
	<div class="badge"></div>
	<div class="badge"></div>
	<div class="badge"></div> -->
	<a class="adopt-btn" href="#">Adopt Me</a>

	<!-- <a class="adopt-btn" href="#">Adopt Me</a>
	<a class="adopt-btn" href="#">Adopt Me</a> -->
	</div>
</div>


<div class="recommender">
	<div class="overlay-close">
	</div>

	<div id="question-1" class="rec-content">
		<h2>What type of space do you have?</h2>
		<ul>
			<li class="choice">I have a small apartment with no yard access.</li>
			<li class="choice">I have an apartment with with plenty of walk times allotted.</li>
			<li class="choice">I have a house with yard access.</li>
		</ul>
		<div class="next-btn">Next <i class="fa fa-angle-right"></i></div>

	</div>
	<div id="question-2" class="rec-content">
		<h2>What is your activity level, with a pet in mind?</h2>
		<ul>
			<li class="choice">I like to take it easy and relax with a snuggle buddy.</li>
			<li class="choice">A total weekend warrior and want a pet that can handle both.</li>
			<li class="choice">I exercise often and want a pet that can keep up.</li>
		</ul>
		<div class="next-btn">Next <i class="fa fa-angle-right"></i></div>
	</div>

	<div id="question-3" class="rec-content">
		<h2>What is your experience level with dogs?</h2>
		<ul>
			<li class="choice">This is my first dog!</li>
			<li class="choice">I’ve had a few dogs but this is my first adoption.</li>
			<li class="choice">I’ve trained many dogs in my time.</li>
		</ul>
		<div class="next-btn">Next <i class="fa fa-angle-right"></i></div>
	</div>

	<div id="question-4" class="rec-content">
		<h2>How much maintenance would you be ok with?</h2>
		<ul>
			<li class="choice">As little as possible.</li>
			<li class="choice">Groomers every now and then are fine.</li>
			<li class="choice">I don’t mind the shedding and grooming! </li>
		</ul>
		<div class="next-btn">Next <i class="fa fa-angle-right"></i></div>
	</div>

	<div id="question-5" class="rec-content multi">
		<h2>Select all ages you would like to see</h2>
		<ul>
			<li class="choice">Young</li>
			<li class="choice">Adult</li>
			<li class="choice">Senior</li>
		</ul>
		<div class="next-btn">Next <i class="fa fa-angle-right"></i></div>
	</div>

	<div id="question-6" class="rec-content">
		<h2>What is your zip code?</h2>
		<ul>
			<li class="choice"><input style="color:black" type="text"/></li>
		</ul>
		<div class="next-btn">Next <i class="fa fa-angle-right"></i></div>

	</div>
	<div id="question-7" class="rec-content">
		<h2>Are you looking for a male or female?</h2>
		<ul>
			<li class="choice">Male</li>
			<li class="choice">Female</li>
			<li class="choice">No Preference</li>
		</ul>
		<div class="next-btn">Next <i class="fa fa-angle-right"></i></div>

	</div>
	<div id="question-8" class="rec-content multi">
		<h2>Are any of these already in your family?</h2>
		<ul>
			<li class="choice">Baby</li>
			<li class="choice">Cat</li>
			<li class="choice">Dog</li>
		</ul>
		<div class="finish-btn">Finish!</i></div>
	</div>


</div>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script src="http://rawgithub.com/desandro/masonry/v2.1.08/jquery.masonry.js"></script>
<script src="http://imagesloaded.desandro.com/imagesloaded.pkgd.js"></script><script src="http://isotope.metafizzy.co/isotope.pkgd.min.js"></script>
<script>

var $container;
	var payload = {};

$( function() {
  $('.recommender').hide();

	$('.rec-content:first').show();
	$('.next-btn').hide();

	$('.rec-content.multi .choice').addClass('faded');

	$('#container').on('click', '.item', function(){
		if($(this).hasClass('selected')) {
			closeDetails();
			return;
		}

		//show details pane
		$('#container .item').removeClass('selected');
		$(this).addClass('selected');
		$('#details-pane').addClass('show');
		$('#main').addClass('details-visible');
		$('.walkthrough-btn').addClass('details-visible');

		 //populate the details pane with specific dog details
		 //get specific dog 
		 // $('#details-pane h1').html(dogData.)
		 var dogId = $(this).attr('data-dog-id');
		 $.ajax('http://hidden-dawn-1745.herokuapp.com/dogs.json?pet_id=' + dogId).done(function(dog){
		 	populateDetails(dog);
		 	$.ajax('http://hidden-dawn-1745.herokuapp.com/shelters.json?shelter_id=' + dog.shelter_id).done(function(shelter){
<<<<<<< HEAD
		 		console.log(shelter);
		 		$("#details-pane .shelter-name").html(shelter.name)
=======
		 		$("#details-pane #shelter-name").html(shelter.name)
        $("#details-pane #shelter-email").html(shelter.email)
        $("#details-pane #shelter-number").html(shelter.phone)
        $("#details-pane #shelter-city").html(shelter.city)
        $("#details-pane #shelter-state").html(shelter.state)

        $('.adopt-btn').attr('href', 'mailto:'+shelter.email+"?subject=Regarding " + dog.name);
>>>>>>> FETCH_HEAD
		 	});
		 });

	})
  
  var populateDetails = function(dog){
  	var $detailsPane = $('#details-pane');
  	$detailsPane.find('h1').html(dog.name)
  	$detailsPane.find('.portrait').attr('src', dog.photos[0].small)
  	$detailsPane.find('.description').html(dog.description)
  }

  var closeDetails = function(){

  	$('#main').removeClass('details-visible');
  	$('#container .item').removeClass('selected');
  	$('.walkthrough-btn').removeClass('details-visible');
  	$('#details-pane').removeClass('show');
  }
  

  $('.fa-times, .top-bar').on('click', function(e){
  	e.stopPropagation();
  	closeDetails();
  });


  $('.walkthrough-btn').on('click', function(){
  	$('.recommender').show();
  });

  $('.walkthrough-btn').hover(function(){
  	$(this).find('img').attr('src', '/static/dogteam/sparkles.png');
  	$(this).css('background', 'black')
  },
  	function(){
  		$(this).find('img').attr('src', '/static/dogteam/sparklesblack.png');
  		$(this).css('background', 'white')

  	})

  $('.recommender .overlay-close').on('click', function(){
  	$('.recommender').hide();
  });

  //choice clicked on non-multi
  $('.rec-content:not(".multi") .choice').on('click', function(){
  	$('.next-btn').fadeIn();
  	 $(this).removeClass('faded');
  	 $(this).siblings().addClass('faded');
  
  });

  //choice clicked on multi
  $('.rec-content.multi .choice').on('click', function(){
  	$('.next-btn').fadeIn();
  	$(this).toggleClass('faded');

  });


  //next clicked 
  $('.next-btn, .finish-btn').on('click', function(){

  	var $currentQuestion = $(this).parent('.rec-content');
  	var currentQuestionId = $currentQuestion.attr('id');

  	if($currentQuestion.hasClass('multi')){
  		var arr = [];
  		$currentQuestion.find('.choice:not(".faded")').each(function(i, item){
  			console.log(item)
  			arr.push($(item).text());
  		})
  		payload[currentQuestionId] = arr;

  	}
  	else {
  		payload[currentQuestionId]= $currentQuestion.find('.choice:not(".faded")').text();
  	}

  	if($(this).hasClass('finish-btn')) {
  		 $.ajax({
  		 	url: 'http://hidden-dawn-1745.herokuapp.com/recommendations/filter.json',
  		 	data: payload
  		 }).done(function(result){
  		 	$('.container').empty();
  		 	dogsData = result.data;
  		  $.each(dogsData, function(i, dog) {
  		  	if(dog.photos[0]) {
  		  		var a = $('<div class="item element"><a class="shadow"><img src="' + dog.photos[0].medium + '" /></a></div>').attr('data-dog-id', dog.id).prependTo('#container');
  		  	}
  		  })
  		});  	
  	}

  	else {
  		//it's a next button
	  	$currentQuestion.fadeOut(function(){
	  		$currentQuestion.next().fadeIn();
	  	});
  	}


  });



  $container = $('#container');

   $container.isotope({
       itemSelector : '.item',
       //disable resizing
       resizable: false,
   });
   //update columnWidth on window resize
   $(window).smartresize(function(){
       $container.isotope({
       });
   });

   // for(var i=0; i < 30; i++) {
   // 	$('<div class="item element"><img src="http://placekitten.com/275/' + (Math.floor(Math.random() * (400 - 200) + 200)) + '" /></div>').prependTo('#container');
   // }
   var dogsData;

   $.ajax('http://hidden-dawn-1745.herokuapp.com/breeds/load.json?ip={{ ip }}').done(function(result){
   	dogsData = result.data;
    $.each(dogsData, function(i, dog) {
    	if(dog.photos[0]) {
    		var a = $('<div class="item element"><a class="shadow"><img src="' + dog.photos[0].medium + '" /></a></div>').attr('data-dog-id', dog.id).prependTo('#container');
    	}
    })
  });




});
</script>

<script>


</script>
</body>
</html>


